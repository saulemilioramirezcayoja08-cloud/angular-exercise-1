<div class="middle">

  <div *ngIf="products.length === 0" class="empty-state">
    <p class="empty-title">No hay productos en la cotización</p>
    <p class="empty-subtitle">Presiona Ctrl + P para buscar y agregar productos</p>
  </div>

  <table class="table" *ngIf="products.length > 0">
    <thead>
    <tr>
      <th class="header">Item</th>
      <th class="header">SKU</th>
      <th class="header">Producto</th>
      <th class="header">Cant</th>
      <th class="header">Precio</th>
      <th class="header">Desc</th>
      <th class="header">Subtotal</th>
      <th class="header">Notas</th>
      <th class="header">Acción</th>
    </tr>
    </thead>
    <tbody>
    <tr class="row" *ngFor="let product of products; let i = index; trackBy: trackByProductId">
      <td class="cell">
        <span class="number">{{ formatItemNumber(i) }}</span>
      </td>
      <td class="cell">
        <span class="code">{{ product.sku }}</span>
      </td>
      <td class="cell">
        <span class="label">{{ product.name }}</span>
      </td>
      <td class="cell">
        <input
          type="number"
          class="input quantity"
          [value]="product.quantity"
          min="1"
          (change)="onQuantityChange(i, $event)">
      </td>
      <td class="cell">
        <input
          type="number"
          class="input price"
          [value]="product.price"
          min="0"
          step="0.01"
          (change)="onPriceChange(i, $event)">
      </td>
      <td class="cell">
        <input
          type="number"
          class="input discount"
          [value]="product.discount"
          min="0"
          max="100"
          step="0.1"
          (change)="onDiscountChange(i, $event)">
      </td>
      <td class="cell">
        <span class="value amount">{{ formatCurrency(calculateSubtotal(product)) }}</span>
      </td>
      <td class="cell">
        <input
          type="text"
          class="input notes"
          [value]="product.notes"
          placeholder="Observaciones..."
          (input)="onNotesInput(i, $event)">
      </td>
      <td class="cell">
        <button
          type="button"
          class="button danger"
          (click)="deleteProduct(i)"
          title="Eliminar producto">
          <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path d="M20.5001 6H3.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
              <path
                d="M6.5 6C6.55588 6 6.58382 6 6.60915 5.99936C7.43259 5.97849 8.15902 5.45491 8.43922 4.68032C8.44784 4.65649 8.45667 4.62999 8.47434 4.57697L8.57143 4.28571C8.65431 4.03708 8.69575 3.91276 8.75071 3.8072C8.97001 3.38607 9.37574 3.09364 9.84461 3.01877C9.96213 3 10.0932 3 10.3553 3H13.6447C13.9068 3 14.0379 3 14.1554 3.01877C14.6243 3.09364 15.03 3.38607 15.2493 3.8072C15.3043 3.91276 15.3457 4.03708 15.4286 4.28571L15.5257 4.57697C15.5433 4.62992 15.5522 4.65651 15.5608 4.68032C15.841 5.45491 16.5674 5.97849 17.3909 5.99936C17.4162 6 17.4441 6 17.5 6"
                stroke="currentColor" stroke-width="1.5"></path>
              <path
                d="M18.3735 15.3991C18.1965 18.054 18.108 19.3815 17.243 20.1907C16.378 21 15.0476 21 12.3868 21H11.6134C8.9526 21 7.6222 21 6.75719 20.1907C5.89218 19.3815 5.80368 18.054 5.62669 15.3991L5.16675 8.5M18.8334 8.5L18.6334 11.5"
                stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
            </g>
          </svg>
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>
